{"ast":null,"code":"import { Grid, ContentBox } from \"../../core/layout\";\nimport { div, position, size, scroll_size, show, hide, display, undisplay, children } from \"../../core/dom\";\nimport { sum, remove_at } from \"../../core/util/array\";\nimport * as p from \"../../core/properties\";\nimport { LayoutDOM, LayoutDOMView } from \"./layout_dom\";\nimport { Model } from \"../../model\";\nimport { bk_left, bk_right, bk_active, bk_side } from \"../../styles/mixins\";\nimport { bk_tabs_header, bk_headers, bk_headers_wrapper, bk_tab, bk_close } from \"../../styles/tabs\";\nimport { bk_btn, bk_btn_default, bk_btn_group } from \"../../styles/buttons\";\nimport { bk_caret } from \"../../styles/menus\";\nexport class TabsView extends LayoutDOMView {\n  connect_signals() {\n    super.connect_signals();\n    this.connect(this.model.properties.tabs.change, () => this.rebuild());\n    this.connect(this.model.properties.active.change, () => this.on_active_change());\n  }\n\n  get child_models() {\n    return this.model.tabs.map(tab => tab.child);\n  }\n\n  _update_layout() {\n    const loc = this.model.tabs_location;\n    const vertical = loc == \"above\" || loc == \"below\"; // XXX: this is a hack, this should be handled by \"fit\" policy in grid layout\n\n    const {\n      scroll_el,\n      headers_el\n    } = this;\n    this.header = new class extends ContentBox {\n      _measure(viewport) {\n        const min_headers = 3;\n        const scroll = size(scroll_el);\n        const headers = children(headers_el).slice(0, min_headers).map(el => size(el));\n\n        const {\n          width,\n          height\n        } = super._measure(viewport);\n\n        if (vertical) {\n          const min_width = scroll.width + sum(headers.map(size => size.width));\n          return {\n            width: viewport.width != Infinity ? viewport.width : min_width,\n            height\n          };\n        } else {\n          const min_height = scroll.height + sum(headers.map(size => size.height));\n          return {\n            width,\n            height: viewport.height != Infinity ? viewport.height : min_height\n          };\n        }\n      }\n\n    }(this.header_el);\n    if (vertical) this.header.set_sizing({\n      width_policy: \"fit\",\n      height_policy: \"fixed\"\n    });else this.header.set_sizing({\n      width_policy: \"fixed\",\n      height_policy: \"fit\"\n    });\n    let row = 1;\n    let col = 1;\n\n    switch (loc) {\n      case \"above\":\n        row -= 1;\n        break;\n\n      case \"below\":\n        row += 1;\n        break;\n\n      case \"left\":\n        col -= 1;\n        break;\n\n      case \"right\":\n        col += 1;\n        break;\n    }\n\n    const header = {\n      layout: this.header,\n      row,\n      col\n    };\n    const panels = this.child_views.map(child_view => {\n      return {\n        layout: child_view.layout,\n        row: 1,\n        col: 1\n      };\n    });\n    this.layout = new Grid([header, ...panels]);\n    this.layout.set_sizing(this.box_sizing());\n  }\n\n  update_position() {\n    super.update_position();\n    this.header_el.style.position = \"absolute\"; // XXX: do it in position()\n\n    position(this.header_el, this.header.bbox);\n    const loc = this.model.tabs_location;\n    const vertical = loc == \"above\" || loc == \"below\";\n    const scroll_el_size = size(this.scroll_el);\n    const headers_el_size = scroll_size(this.headers_el);\n\n    if (vertical) {\n      const {\n        width\n      } = this.header.bbox;\n\n      if (headers_el_size.width > width) {\n        this.wrapper_el.style.maxWidth = `${width - scroll_el_size.width}px`;\n        display(this.scroll_el);\n      } else {\n        this.wrapper_el.style.maxWidth = \"\";\n        undisplay(this.scroll_el);\n      }\n    } else {\n      const {\n        height\n      } = this.header.bbox;\n\n      if (headers_el_size.height > height) {\n        this.wrapper_el.style.maxHeight = `${height - scroll_el_size.height}px`;\n        display(this.scroll_el);\n      } else {\n        this.wrapper_el.style.maxHeight = \"\";\n        undisplay(this.scroll_el);\n      }\n    }\n\n    const {\n      child_views\n    } = this;\n\n    for (const child_view of child_views) hide(child_view.el);\n\n    const tab = child_views[this.model.active];\n    if (tab != null) show(tab.el);\n  }\n\n  render() {\n    super.render();\n    const {\n      active\n    } = this.model;\n    const loc = this.model.tabs_location;\n    const vertical = loc == \"above\" || loc == \"below\";\n    const headers = this.model.tabs.map((tab, i) => {\n      const el = div({\n        class: [bk_tab, i == active ? bk_active : null]\n      }, tab.title);\n      el.addEventListener(\"click\", event => {\n        if (event.target == event.currentTarget) this.change_active(i);\n      });\n\n      if (tab.closable) {\n        const close_el = div({\n          class: bk_close\n        });\n        close_el.addEventListener(\"click\", event => {\n          if (event.target == event.currentTarget) {\n            this.model.tabs = remove_at(this.model.tabs, i);\n            const ntabs = this.model.tabs.length;\n            if (this.model.active > ntabs - 1) this.model.active = ntabs - 1;\n          }\n        });\n        el.appendChild(close_el);\n      }\n\n      return el;\n    });\n    this.headers_el = div({\n      class: [bk_headers]\n    }, headers);\n    this.wrapper_el = div({\n      class: bk_headers_wrapper\n    }, this.headers_el);\n    const left_el = div({\n      class: [bk_btn, bk_btn_default],\n      disabled: \"\"\n    }, div({\n      class: [bk_caret, bk_left]\n    }));\n    const right_el = div({\n      class: [bk_btn, bk_btn_default]\n    }, div({\n      class: [bk_caret, bk_right]\n    }));\n    let scroll_index = 0;\n\n    const do_scroll = dir => {\n      return () => {\n        const ntabs = this.model.tabs.length;\n        if (dir == \"left\") scroll_index = Math.max(scroll_index - 1, 0);else scroll_index = Math.min(scroll_index + 1, ntabs - 1);\n        if (scroll_index == 0) left_el.setAttribute(\"disabled\", \"\");else left_el.removeAttribute(\"disabled\");\n        if (scroll_index == ntabs - 1) right_el.setAttribute(\"disabled\", \"\");else right_el.removeAttribute(\"disabled\");\n        const sizes = children(this.headers_el).slice(0, scroll_index).map(el => el.getBoundingClientRect());\n\n        if (vertical) {\n          const left = -sum(sizes.map(size => size.width));\n          this.headers_el.style.left = `${left}px`;\n        } else {\n          const top = -sum(sizes.map(size => size.height));\n          this.headers_el.style.top = `${top}px`;\n        }\n      };\n    };\n\n    left_el.addEventListener(\"click\", do_scroll(\"left\"));\n    right_el.addEventListener(\"click\", do_scroll(\"right\"));\n    this.scroll_el = div({\n      class: bk_btn_group\n    }, left_el, right_el);\n    this.header_el = div({\n      class: [bk_tabs_header, bk_side(loc)]\n    }, this.scroll_el, this.wrapper_el);\n    this.el.appendChild(this.header_el);\n  }\n\n  change_active(i) {\n    if (i != this.model.active) {\n      this.model.active = i;\n    }\n  }\n\n  on_active_change() {\n    const i = this.model.active;\n    const headers = children(this.headers_el);\n\n    for (const el of headers) el.classList.remove(bk_active);\n\n    headers[i].classList.add(bk_active);\n    const {\n      child_views\n    } = this;\n\n    for (const child_view of child_views) hide(child_view.el);\n\n    show(child_views[i].el);\n  }\n\n}\nTabsView.__name__ = \"TabsView\";\nexport class Tabs extends LayoutDOM {\n  constructor(attrs) {\n    super(attrs);\n  }\n\n  static init_Tabs() {\n    this.prototype.default_view = TabsView;\n    this.define({\n      tabs: [p.Array, []],\n      tabs_location: [p.Location, \"above\"],\n      active: [p.Number, 0]\n    });\n  }\n\n}\nTabs.__name__ = \"Tabs\";\nTabs.init_Tabs();\nexport class Panel extends Model {\n  constructor(attrs) {\n    super(attrs);\n  }\n\n  static init_Panel() {\n    this.define({\n      title: [p.String, \"\"],\n      child: [p.Instance],\n      closable: [p.Boolean, false]\n    });\n  }\n\n}\nPanel.__name__ = \"Panel\";\nPanel.init_Panel();","map":{"version":3,"sources":["/Users/gen/Desktop/defund_to_refund/node_modules/@bokeh/bokehjs/build/js/lib/models/layouts/tabs.js"],"names":["Grid","ContentBox","div","position","size","scroll_size","show","hide","display","undisplay","children","sum","remove_at","p","LayoutDOM","LayoutDOMView","Model","bk_left","bk_right","bk_active","bk_side","bk_tabs_header","bk_headers","bk_headers_wrapper","bk_tab","bk_close","bk_btn","bk_btn_default","bk_btn_group","bk_caret","TabsView","connect_signals","connect","model","properties","tabs","change","rebuild","active","on_active_change","child_models","map","tab","child","_update_layout","loc","tabs_location","vertical","scroll_el","headers_el","header","_measure","viewport","min_headers","scroll","headers","slice","el","width","height","min_width","Infinity","min_height","header_el","set_sizing","width_policy","height_policy","row","col","layout","panels","child_views","child_view","box_sizing","update_position","style","bbox","scroll_el_size","headers_el_size","wrapper_el","maxWidth","maxHeight","render","i","class","title","addEventListener","event","target","currentTarget","change_active","closable","close_el","ntabs","length","appendChild","left_el","disabled","right_el","scroll_index","do_scroll","dir","Math","max","min","setAttribute","removeAttribute","sizes","getBoundingClientRect","left","top","classList","remove","add","__name__","Tabs","constructor","attrs","init_Tabs","prototype","default_view","define","Array","Location","Number","Panel","init_Panel","String","Instance","Boolean"],"mappings":"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","sourcesContent":["import { Grid, ContentBox } from \"../../core/layout\";\nimport { div, position, size, scroll_size, show, hide, display, undisplay, children } from \"../../core/dom\";\nimport { sum, remove_at } from \"../../core/util/array\";\nimport * as p from \"../../core/properties\";\nimport { LayoutDOM, LayoutDOMView } from \"./layout_dom\";\nimport { Model } from \"../../model\";\nimport { bk_left, bk_right, bk_active, bk_side } from \"../../styles/mixins\";\nimport { bk_tabs_header, bk_headers, bk_headers_wrapper, bk_tab, bk_close } from \"../../styles/tabs\";\nimport { bk_btn, bk_btn_default, bk_btn_group } from \"../../styles/buttons\";\nimport { bk_caret } from \"../../styles/menus\";\nexport class TabsView extends LayoutDOMView {\n    connect_signals() {\n        super.connect_signals();\n        this.connect(this.model.properties.tabs.change, () => this.rebuild());\n        this.connect(this.model.properties.active.change, () => this.on_active_change());\n    }\n    get child_models() {\n        return this.model.tabs.map((tab) => tab.child);\n    }\n    _update_layout() {\n        const loc = this.model.tabs_location;\n        const vertical = loc == \"above\" || loc == \"below\";\n        // XXX: this is a hack, this should be handled by \"fit\" policy in grid layout\n        const { scroll_el, headers_el } = this;\n        this.header = new class extends ContentBox {\n            _measure(viewport) {\n                const min_headers = 3;\n                const scroll = size(scroll_el);\n                const headers = children(headers_el).slice(0, min_headers).map((el) => size(el));\n                const { width, height } = super._measure(viewport);\n                if (vertical) {\n                    const min_width = scroll.width + sum(headers.map((size) => size.width));\n                    return { width: viewport.width != Infinity ? viewport.width : min_width, height };\n                }\n                else {\n                    const min_height = scroll.height + sum(headers.map((size) => size.height));\n                    return { width, height: viewport.height != Infinity ? viewport.height : min_height };\n                }\n            }\n        }(this.header_el);\n        if (vertical)\n            this.header.set_sizing({ width_policy: \"fit\", height_policy: \"fixed\" });\n        else\n            this.header.set_sizing({ width_policy: \"fixed\", height_policy: \"fit\" });\n        let row = 1;\n        let col = 1;\n        switch (loc) {\n            case \"above\":\n                row -= 1;\n                break;\n            case \"below\":\n                row += 1;\n                break;\n            case \"left\":\n                col -= 1;\n                break;\n            case \"right\":\n                col += 1;\n                break;\n        }\n        const header = { layout: this.header, row, col };\n        const panels = this.child_views.map((child_view) => {\n            return { layout: child_view.layout, row: 1, col: 1 };\n        });\n        this.layout = new Grid([header, ...panels]);\n        this.layout.set_sizing(this.box_sizing());\n    }\n    update_position() {\n        super.update_position();\n        this.header_el.style.position = \"absolute\"; // XXX: do it in position()\n        position(this.header_el, this.header.bbox);\n        const loc = this.model.tabs_location;\n        const vertical = loc == \"above\" || loc == \"below\";\n        const scroll_el_size = size(this.scroll_el);\n        const headers_el_size = scroll_size(this.headers_el);\n        if (vertical) {\n            const { width } = this.header.bbox;\n            if (headers_el_size.width > width) {\n                this.wrapper_el.style.maxWidth = `${width - scroll_el_size.width}px`;\n                display(this.scroll_el);\n            }\n            else {\n                this.wrapper_el.style.maxWidth = \"\";\n                undisplay(this.scroll_el);\n            }\n        }\n        else {\n            const { height } = this.header.bbox;\n            if (headers_el_size.height > height) {\n                this.wrapper_el.style.maxHeight = `${height - scroll_el_size.height}px`;\n                display(this.scroll_el);\n            }\n            else {\n                this.wrapper_el.style.maxHeight = \"\";\n                undisplay(this.scroll_el);\n            }\n        }\n        const { child_views } = this;\n        for (const child_view of child_views)\n            hide(child_view.el);\n        const tab = child_views[this.model.active];\n        if (tab != null)\n            show(tab.el);\n    }\n    render() {\n        super.render();\n        const { active } = this.model;\n        const loc = this.model.tabs_location;\n        const vertical = loc == \"above\" || loc == \"below\";\n        const headers = this.model.tabs.map((tab, i) => {\n            const el = div({ class: [bk_tab, i == active ? bk_active : null] }, tab.title);\n            el.addEventListener(\"click\", (event) => {\n                if (event.target == event.currentTarget)\n                    this.change_active(i);\n            });\n            if (tab.closable) {\n                const close_el = div({ class: bk_close });\n                close_el.addEventListener(\"click\", (event) => {\n                    if (event.target == event.currentTarget) {\n                        this.model.tabs = remove_at(this.model.tabs, i);\n                        const ntabs = this.model.tabs.length;\n                        if (this.model.active > ntabs - 1)\n                            this.model.active = ntabs - 1;\n                    }\n                });\n                el.appendChild(close_el);\n            }\n            return el;\n        });\n        this.headers_el = div({ class: [bk_headers] }, headers);\n        this.wrapper_el = div({ class: bk_headers_wrapper }, this.headers_el);\n        const left_el = div({ class: [bk_btn, bk_btn_default], disabled: \"\" }, div({ class: [bk_caret, bk_left] }));\n        const right_el = div({ class: [bk_btn, bk_btn_default] }, div({ class: [bk_caret, bk_right] }));\n        let scroll_index = 0;\n        const do_scroll = (dir) => {\n            return () => {\n                const ntabs = this.model.tabs.length;\n                if (dir == \"left\")\n                    scroll_index = Math.max(scroll_index - 1, 0);\n                else\n                    scroll_index = Math.min(scroll_index + 1, ntabs - 1);\n                if (scroll_index == 0)\n                    left_el.setAttribute(\"disabled\", \"\");\n                else\n                    left_el.removeAttribute(\"disabled\");\n                if (scroll_index == ntabs - 1)\n                    right_el.setAttribute(\"disabled\", \"\");\n                else\n                    right_el.removeAttribute(\"disabled\");\n                const sizes = children(this.headers_el)\n                    .slice(0, scroll_index)\n                    .map((el) => el.getBoundingClientRect());\n                if (vertical) {\n                    const left = -sum(sizes.map((size) => size.width));\n                    this.headers_el.style.left = `${left}px`;\n                }\n                else {\n                    const top = -sum(sizes.map((size) => size.height));\n                    this.headers_el.style.top = `${top}px`;\n                }\n            };\n        };\n        left_el.addEventListener(\"click\", do_scroll(\"left\"));\n        right_el.addEventListener(\"click\", do_scroll(\"right\"));\n        this.scroll_el = div({ class: bk_btn_group }, left_el, right_el);\n        this.header_el = div({ class: [bk_tabs_header, bk_side(loc)] }, this.scroll_el, this.wrapper_el);\n        this.el.appendChild(this.header_el);\n    }\n    change_active(i) {\n        if (i != this.model.active) {\n            this.model.active = i;\n        }\n    }\n    on_active_change() {\n        const i = this.model.active;\n        const headers = children(this.headers_el);\n        for (const el of headers)\n            el.classList.remove(bk_active);\n        headers[i].classList.add(bk_active);\n        const { child_views } = this;\n        for (const child_view of child_views)\n            hide(child_view.el);\n        show(child_views[i].el);\n    }\n}\nTabsView.__name__ = \"TabsView\";\nexport class Tabs extends LayoutDOM {\n    constructor(attrs) {\n        super(attrs);\n    }\n    static init_Tabs() {\n        this.prototype.default_view = TabsView;\n        this.define({\n            tabs: [p.Array, []],\n            tabs_location: [p.Location, \"above\"],\n            active: [p.Number, 0],\n        });\n    }\n}\nTabs.__name__ = \"Tabs\";\nTabs.init_Tabs();\nexport class Panel extends Model {\n    constructor(attrs) {\n        super(attrs);\n    }\n    static init_Panel() {\n        this.define({\n            title: [p.String, \"\"],\n            child: [p.Instance],\n            closable: [p.Boolean, false],\n        });\n    }\n}\nPanel.__name__ = \"Panel\";\nPanel.init_Panel();\n//# sourceMappingURL=tabs.js.map"]},"metadata":{},"sourceType":"module"}