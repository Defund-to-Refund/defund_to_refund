{"ast":null,"code":"import { Signal0, Signal, Signalable } from \"./signaling\";\nimport * as enums from \"./enums\";\nimport { includes, repeat } from \"./util/array\";\nimport { map } from \"./util/arrayable\";\nimport { is_color } from \"./util/color\";\nimport { isBoolean, isNumber, isString, isArray, isPlainObject } from \"./util/types\";\nimport { settings } from \"./settings\"; // XXX: silence TS, because `Signal` appears in declarations due to Signalable\n\nSignal; // lgtm [js/useless-expression]\n\nfunction valueToString(value) {\n  try {\n    return JSON.stringify(value);\n  } catch (_a) {\n    return value.toString();\n  }\n}\n\nexport function isSpec(obj) {\n  return isPlainObject(obj) && (obj.value === undefined ? 0 : 1) + (obj.field === undefined ? 0 : 1) + (obj.expr === undefined ? 0 : 1) == 1; // garbage JS XOR\n}\nexport class Property extends Signalable() {\n  constructor(obj, attr, default_value) {\n    super();\n    this.obj = obj;\n    this.attr = attr;\n    this.default_value = default_value;\n    this.optional = false;\n    this.change = new Signal0(this.obj, \"change\");\n\n    this._init();\n\n    this.connect(this.change, () => this._init());\n  }\n\n  update() {\n    this._init();\n  } // ----- customizable policies\n\n\n  init() {}\n\n  transform(values) {\n    return values;\n  }\n\n  validate(value) {\n    if (!this.valid(value)) throw new Error(`${this.obj.type}.${this.attr} given invalid value: ${valueToString(value)}`);\n  }\n\n  valid(_value) {\n    return true;\n  } // ----- property accessors\n\n\n  value(do_spec_transform = true) {\n    if (this.spec.value === undefined) throw new Error(\"attempted to retrieve property value for property without value specification\");\n    let ret = this.transform([this.spec.value])[0];\n    if (this.spec.transform != null && do_spec_transform) ret = this.spec.transform.compute(ret);\n    return ret;\n  } // ----- private methods\n\n  /*protected*/\n\n\n  _init() {\n    const obj = this.obj;\n    const attr = this.attr;\n    let attr_value = obj.getv(attr);\n\n    if (attr_value === undefined) {\n      const default_value = this.default_value;\n      if (this._default_override != null) attr_value = this._default_override();else if (default_value !== undefined) attr_value = default_value(obj);else attr_value = null;\n      obj.setv({\n        [attr]: attr_value\n      }, {\n        silent: true,\n        defaults: true\n      });\n    }\n\n    if (isArray(attr_value)) this.spec = {\n      value: attr_value\n    };else if (isSpec(attr_value)) this.spec = attr_value;else this.spec = {\n      value: attr_value\n    }; //if (this.dataspec && this.spec.field != null && !isString(this.spec.field))\n    //  throw new Error(`field value for property '${attr}' is not a string`)\n\n    if (this.spec.value != null) this.validate(this.spec.value);\n    this.init();\n  }\n\n  toString() {\n    /*${this.name}*/\n    return `Prop(${this.obj}.${this.attr}, spec: ${valueToString(this.spec)})`;\n  }\n\n}\nProperty.__name__ = \"Property\"; //\n// Primitive Properties\n//\n\nexport class Any extends Property {}\nAny.__name__ = \"Any\";\nexport class Array extends Property {\n  valid(value) {\n    return isArray(value) || value instanceof Float64Array;\n  }\n\n}\nArray.__name__ = \"Array\";\nexport class Boolean extends Property {\n  valid(value) {\n    return isBoolean(value);\n  }\n\n}\nBoolean.__name__ = \"Boolean\";\nexport class Color extends Property {\n  valid(value) {\n    return isString(value) && is_color(value);\n  }\n\n}\nColor.__name__ = \"Color\";\nexport class Instance extends Property {}\nInstance.__name__ = \"Instance\";\nexport class Number extends Property {\n  valid(value) {\n    return isNumber(value);\n  }\n\n}\nNumber.__name__ = \"Number\";\nexport class Int extends Number {\n  valid(value) {\n    return isNumber(value) && (value | 0) == value;\n  }\n\n}\nInt.__name__ = \"Int\";\nexport class Angle extends Number {}\nAngle.__name__ = \"Angle\";\nexport class Percent extends Number {\n  valid(value) {\n    return isNumber(value) && 0 <= value && value <= 1.0;\n  }\n\n}\nPercent.__name__ = \"Percent\";\nexport class String extends Property {\n  valid(value) {\n    return isString(value);\n  }\n\n}\nString.__name__ = \"String\";\nexport class FontSize extends String {}\nFontSize.__name__ = \"FontSize\";\nexport class Font extends String {\n  constructor() {\n    super(...arguments);\n    this._default_override = settings.dev ? () => \"Bokeh\" : undefined;\n  }\n\n}\nFont.__name__ = \"Font\"; //\n// Enum properties\n//\n\nexport class EnumProperty extends Property {\n  valid(value) {\n    return isString(value) && includes(this.enum_values, value);\n  }\n\n}\nEnumProperty.__name__ = \"EnumProperty\";\nexport function Enum(values) {\n  return class extends EnumProperty {\n    get enum_values() {\n      return values;\n    }\n\n  };\n}\nexport class Direction extends EnumProperty {\n  get enum_values() {\n    return enums.Direction;\n  }\n\n  transform(values) {\n    const result = new Uint8Array(values.length);\n\n    for (let i = 0; i < values.length; i++) {\n      switch (values[i]) {\n        case \"clock\":\n          result[i] = 0;\n          break;\n\n        case \"anticlock\":\n          result[i] = 1;\n          break;\n      }\n    }\n\n    return result;\n  }\n\n}\nDirection.__name__ = \"Direction\";\nexport const Anchor = Enum(enums.Anchor);\nexport const AngleUnits = Enum(enums.AngleUnits);\nexport const BoxOrigin = Enum(enums.BoxOrigin);\nexport const ButtonType = Enum(enums.ButtonType);\nexport const CalendarPosition = Enum(enums.CalendarPosition);\nexport const Dimension = Enum(enums.Dimension);\nexport const Dimensions = Enum(enums.Dimensions);\nexport const Distribution = Enum(enums.Distribution);\nexport const FontStyle = Enum(enums.FontStyle);\nexport const HatchPatternType = Enum(enums.HatchPatternType);\nexport const HTTPMethod = Enum(enums.HTTPMethod);\nexport const HexTileOrientation = Enum(enums.HexTileOrientation);\nexport const HoverMode = Enum(enums.HoverMode);\nexport const LatLon = Enum(enums.LatLon);\nexport const LegendClickPolicy = Enum(enums.LegendClickPolicy);\nexport const LegendLocation = Enum(enums.LegendLocation);\nexport const LineCap = Enum(enums.LineCap);\nexport const LineJoin = Enum(enums.LineJoin);\nexport const LinePolicy = Enum(enums.LinePolicy);\nexport const Location = Enum(enums.Location);\nexport const Logo = Enum(enums.Logo);\nexport const MarkerType = Enum(enums.MarkerType);\nexport const MutedPolicy = Enum(enums.MutedPolicy);\nexport const Orientation = Enum(enums.Orientation);\nexport const OutputBackend = Enum(enums.OutputBackend);\nexport const PaddingUnits = Enum(enums.PaddingUnits);\nexport const Place = Enum(enums.Place);\nexport const PointPolicy = Enum(enums.PointPolicy);\nexport const RadiusDimension = Enum(enums.RadiusDimension);\nexport const RenderLevel = Enum(enums.RenderLevel);\nexport const RenderMode = Enum(enums.RenderMode);\nexport const ResetPolicy = Enum(enums.ResetPolicy);\nexport const RoundingFunction = Enum(enums.RoundingFunction);\nexport const Side = Enum(enums.Side);\nexport const SizingMode = Enum(enums.SizingMode);\nexport const Sort = Enum(enums.Sort);\nexport const SpatialUnits = Enum(enums.SpatialUnits);\nexport const StartEnd = Enum(enums.StartEnd);\nexport const StepMode = Enum(enums.StepMode);\nexport const TapBehavior = Enum(enums.TapBehavior);\nexport const TextAlign = Enum(enums.TextAlign);\nexport const TextBaseline = Enum(enums.TextBaseline);\nexport const TextureRepetition = Enum(enums.TextureRepetition);\nexport const TickLabelOrientation = Enum(enums.TickLabelOrientation);\nexport const TooltipAttachment = Enum(enums.TooltipAttachment);\nexport const UpdateMode = Enum(enums.UpdateMode);\nexport const VerticalAlign = Enum(enums.VerticalAlign); //\n// DataSpec properties\n//\n\nexport class ScalarSpec extends Property {}\nScalarSpec.__name__ = \"ScalarSpec\";\nexport class VectorSpec extends Property {\n  array(source) {\n    let ret;\n\n    if (this.spec.field != null) {\n      ret = this.transform(source.get_column(this.spec.field));\n      if (ret == null) throw new Error(`attempted to retrieve property array for nonexistent field '${this.spec.field}'`);\n    } else if (this.spec.expr != null) {\n      ret = this.transform(this.spec.expr.v_compute(source));\n    } else {\n      let length = source.get_length();\n      if (length == null) length = 1;\n      const value = this.value(false); // don't apply any spec transform\n\n      ret = repeat(value, length);\n    }\n\n    if (this.spec.transform != null) ret = this.spec.transform.v_compute(ret);\n    return ret;\n  }\n\n}\nVectorSpec.__name__ = \"VectorSpec\";\nexport class DataSpec extends VectorSpec {}\nDataSpec.__name__ = \"DataSpec\";\nexport class UnitsSpec extends VectorSpec {\n  init() {\n    if (this.spec.units == null) this.spec.units = this.default_units;\n    const units = this.spec.units;\n    if (!includes(this.valid_units, units)) throw new Error(`units must be one of ${this.valid_units.join(\", \")}; got: ${units}`);\n  }\n\n  get units() {\n    return this.spec.units;\n  }\n\n  set units(units) {\n    this.spec.units = units;\n  }\n\n}\nUnitsSpec.__name__ = \"UnitsSpec\";\nexport class AngleSpec extends UnitsSpec {\n  get default_units() {\n    return \"rad\";\n  }\n\n  get valid_units() {\n    return enums.AngleUnits;\n  }\n\n  transform(values) {\n    if (this.spec.units == \"deg\") values = map(values, x => x * Math.PI / 180.0);\n    values = map(values, x => -x);\n    return super.transform(values);\n  }\n\n}\nAngleSpec.__name__ = \"AngleSpec\";\nexport class BooleanSpec extends DataSpec {}\nBooleanSpec.__name__ = \"BooleanSpec\";\nexport class ColorSpec extends DataSpec {}\nColorSpec.__name__ = \"ColorSpec\";\nexport class CoordinateSpec extends DataSpec {}\nCoordinateSpec.__name__ = \"CoordinateSpec\";\nexport class CoordinateSeqSpec extends DataSpec {}\nCoordinateSeqSpec.__name__ = \"CoordinateSeqSpec\";\nexport class DistanceSpec extends UnitsSpec {\n  get default_units() {\n    return \"data\";\n  }\n\n  get valid_units() {\n    return enums.SpatialUnits;\n  }\n\n}\nDistanceSpec.__name__ = \"DistanceSpec\";\nexport class FontSizeSpec extends DataSpec {}\nFontSizeSpec.__name__ = \"FontSizeSpec\";\nexport class MarkerSpec extends DataSpec {}\nMarkerSpec.__name__ = \"MarkerSpec\";\nexport class NumberSpec extends DataSpec {}\nNumberSpec.__name__ = \"NumberSpec\";\nexport class StringSpec extends DataSpec {}\nStringSpec.__name__ = \"StringSpec\";\nexport class NullStringSpec extends DataSpec {}\nNullStringSpec.__name__ = \"NullStringSpec\";","map":{"version":3,"sources":["/Users/gen/Desktop/defund_to_refund/node_modules/@bokeh/bokehjs/build/js/lib/core/properties.js"],"names":["Signal0","Signal","Signalable","enums","includes","repeat","map","is_color","isBoolean","isNumber","isString","isArray","isPlainObject","settings","valueToString","value","JSON","stringify","_a","toString","isSpec","obj","undefined","field","expr","Property","constructor","attr","default_value","optional","change","_init","connect","update","init","transform","values","validate","valid","Error","type","_value","do_spec_transform","spec","ret","compute","attr_value","getv","_default_override","setv","silent","defaults","__name__","Any","Array","Float64Array","Boolean","Color","Instance","Number","Int","Angle","Percent","String","FontSize","Font","arguments","dev","EnumProperty","enum_values","Enum","Direction","result","Uint8Array","length","i","Anchor","AngleUnits","BoxOrigin","ButtonType","CalendarPosition","Dimension","Dimensions","Distribution","FontStyle","HatchPatternType","HTTPMethod","HexTileOrientation","HoverMode","LatLon","LegendClickPolicy","LegendLocation","LineCap","LineJoin","LinePolicy","Location","Logo","MarkerType","MutedPolicy","Orientation","OutputBackend","PaddingUnits","Place","PointPolicy","RadiusDimension","RenderLevel","RenderMode","ResetPolicy","RoundingFunction","Side","SizingMode","Sort","SpatialUnits","StartEnd","StepMode","TapBehavior","TextAlign","TextBaseline","TextureRepetition","TickLabelOrientation","TooltipAttachment","UpdateMode","VerticalAlign","ScalarSpec","VectorSpec","array","source","get_column","v_compute","get_length","DataSpec","UnitsSpec","units","default_units","valid_units","join","AngleSpec","x","Math","PI","BooleanSpec","ColorSpec","CoordinateSpec","CoordinateSeqSpec","DistanceSpec","FontSizeSpec","MarkerSpec","NumberSpec","StringSpec","NullStringSpec"],"mappings":"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","sourcesContent":["import { Signal0, Signal, Signalable } from \"./signaling\";\nimport * as enums from \"./enums\";\nimport { includes, repeat } from \"./util/array\";\nimport { map } from \"./util/arrayable\";\nimport { is_color } from \"./util/color\";\nimport { isBoolean, isNumber, isString, isArray, isPlainObject } from \"./util/types\";\nimport { settings } from \"./settings\";\n// XXX: silence TS, because `Signal` appears in declarations due to Signalable\nSignal; // lgtm [js/useless-expression]\nfunction valueToString(value) {\n    try {\n        return JSON.stringify(value);\n    }\n    catch (_a) {\n        return value.toString();\n    }\n}\nexport function isSpec(obj) {\n    return isPlainObject(obj) &&\n        ((obj.value === undefined ? 0 : 1) +\n            (obj.field === undefined ? 0 : 1) +\n            (obj.expr === undefined ? 0 : 1) == 1); // garbage JS XOR\n}\nexport class Property extends Signalable() {\n    constructor(obj, attr, default_value) {\n        super();\n        this.obj = obj;\n        this.attr = attr;\n        this.default_value = default_value;\n        this.optional = false;\n        this.change = new Signal0(this.obj, \"change\");\n        this._init();\n        this.connect(this.change, () => this._init());\n    }\n    update() {\n        this._init();\n    }\n    // ----- customizable policies\n    init() { }\n    transform(values) {\n        return values;\n    }\n    validate(value) {\n        if (!this.valid(value))\n            throw new Error(`${this.obj.type}.${this.attr} given invalid value: ${valueToString(value)}`);\n    }\n    valid(_value) {\n        return true;\n    }\n    // ----- property accessors\n    value(do_spec_transform = true) {\n        if (this.spec.value === undefined)\n            throw new Error(\"attempted to retrieve property value for property without value specification\");\n        let ret = this.transform([this.spec.value])[0];\n        if (this.spec.transform != null && do_spec_transform)\n            ret = this.spec.transform.compute(ret);\n        return ret;\n    }\n    // ----- private methods\n    /*protected*/ _init() {\n        const obj = this.obj;\n        const attr = this.attr;\n        let attr_value = obj.getv(attr);\n        if (attr_value === undefined) {\n            const default_value = this.default_value;\n            if (this._default_override != null)\n                attr_value = this._default_override();\n            else if (default_value !== undefined)\n                attr_value = default_value(obj);\n            else\n                attr_value = null;\n            obj.setv({ [attr]: attr_value }, { silent: true, defaults: true });\n        }\n        if (isArray(attr_value))\n            this.spec = { value: attr_value };\n        else if (isSpec(attr_value))\n            this.spec = attr_value;\n        else\n            this.spec = { value: attr_value };\n        //if (this.dataspec && this.spec.field != null && !isString(this.spec.field))\n        //  throw new Error(`field value for property '${attr}' is not a string`)\n        if (this.spec.value != null)\n            this.validate(this.spec.value);\n        this.init();\n    }\n    toString() {\n        /*${this.name}*/\n        return `Prop(${this.obj}.${this.attr}, spec: ${valueToString(this.spec)})`;\n    }\n}\nProperty.__name__ = \"Property\";\n//\n// Primitive Properties\n//\nexport class Any extends Property {\n}\nAny.__name__ = \"Any\";\nexport class Array extends Property {\n    valid(value) {\n        return isArray(value) || value instanceof Float64Array;\n    }\n}\nArray.__name__ = \"Array\";\nexport class Boolean extends Property {\n    valid(value) {\n        return isBoolean(value);\n    }\n}\nBoolean.__name__ = \"Boolean\";\nexport class Color extends Property {\n    valid(value) {\n        return isString(value) && is_color(value);\n    }\n}\nColor.__name__ = \"Color\";\nexport class Instance extends Property {\n}\nInstance.__name__ = \"Instance\";\nexport class Number extends Property {\n    valid(value) {\n        return isNumber(value);\n    }\n}\nNumber.__name__ = \"Number\";\nexport class Int extends Number {\n    valid(value) {\n        return isNumber(value) && (value | 0) == value;\n    }\n}\nInt.__name__ = \"Int\";\nexport class Angle extends Number {\n}\nAngle.__name__ = \"Angle\";\nexport class Percent extends Number {\n    valid(value) {\n        return isNumber(value) && 0 <= value && value <= 1.0;\n    }\n}\nPercent.__name__ = \"Percent\";\nexport class String extends Property {\n    valid(value) {\n        return isString(value);\n    }\n}\nString.__name__ = \"String\";\nexport class FontSize extends String {\n}\nFontSize.__name__ = \"FontSize\";\nexport class Font extends String {\n    constructor() {\n        super(...arguments);\n        this._default_override = settings.dev ? () => \"Bokeh\" : undefined;\n    }\n}\nFont.__name__ = \"Font\";\n//\n// Enum properties\n//\nexport class EnumProperty extends Property {\n    valid(value) {\n        return isString(value) && includes(this.enum_values, value);\n    }\n}\nEnumProperty.__name__ = \"EnumProperty\";\nexport function Enum(values) {\n    return class extends EnumProperty {\n        get enum_values() {\n            return values;\n        }\n    };\n}\nexport class Direction extends EnumProperty {\n    get enum_values() {\n        return enums.Direction;\n    }\n    transform(values) {\n        const result = new Uint8Array(values.length);\n        for (let i = 0; i < values.length; i++) {\n            switch (values[i]) {\n                case \"clock\":\n                    result[i] = 0;\n                    break;\n                case \"anticlock\":\n                    result[i] = 1;\n                    break;\n            }\n        }\n        return result;\n    }\n}\nDirection.__name__ = \"Direction\";\nexport const Anchor = Enum(enums.Anchor);\nexport const AngleUnits = Enum(enums.AngleUnits);\nexport const BoxOrigin = Enum(enums.BoxOrigin);\nexport const ButtonType = Enum(enums.ButtonType);\nexport const CalendarPosition = Enum(enums.CalendarPosition);\nexport const Dimension = Enum(enums.Dimension);\nexport const Dimensions = Enum(enums.Dimensions);\nexport const Distribution = Enum(enums.Distribution);\nexport const FontStyle = Enum(enums.FontStyle);\nexport const HatchPatternType = Enum(enums.HatchPatternType);\nexport const HTTPMethod = Enum(enums.HTTPMethod);\nexport const HexTileOrientation = Enum(enums.HexTileOrientation);\nexport const HoverMode = Enum(enums.HoverMode);\nexport const LatLon = Enum(enums.LatLon);\nexport const LegendClickPolicy = Enum(enums.LegendClickPolicy);\nexport const LegendLocation = Enum(enums.LegendLocation);\nexport const LineCap = Enum(enums.LineCap);\nexport const LineJoin = Enum(enums.LineJoin);\nexport const LinePolicy = Enum(enums.LinePolicy);\nexport const Location = Enum(enums.Location);\nexport const Logo = Enum(enums.Logo);\nexport const MarkerType = Enum(enums.MarkerType);\nexport const MutedPolicy = Enum(enums.MutedPolicy);\nexport const Orientation = Enum(enums.Orientation);\nexport const OutputBackend = Enum(enums.OutputBackend);\nexport const PaddingUnits = Enum(enums.PaddingUnits);\nexport const Place = Enum(enums.Place);\nexport const PointPolicy = Enum(enums.PointPolicy);\nexport const RadiusDimension = Enum(enums.RadiusDimension);\nexport const RenderLevel = Enum(enums.RenderLevel);\nexport const RenderMode = Enum(enums.RenderMode);\nexport const ResetPolicy = Enum(enums.ResetPolicy);\nexport const RoundingFunction = Enum(enums.RoundingFunction);\nexport const Side = Enum(enums.Side);\nexport const SizingMode = Enum(enums.SizingMode);\nexport const Sort = Enum(enums.Sort);\nexport const SpatialUnits = Enum(enums.SpatialUnits);\nexport const StartEnd = Enum(enums.StartEnd);\nexport const StepMode = Enum(enums.StepMode);\nexport const TapBehavior = Enum(enums.TapBehavior);\nexport const TextAlign = Enum(enums.TextAlign);\nexport const TextBaseline = Enum(enums.TextBaseline);\nexport const TextureRepetition = Enum(enums.TextureRepetition);\nexport const TickLabelOrientation = Enum(enums.TickLabelOrientation);\nexport const TooltipAttachment = Enum(enums.TooltipAttachment);\nexport const UpdateMode = Enum(enums.UpdateMode);\nexport const VerticalAlign = Enum(enums.VerticalAlign);\n//\n// DataSpec properties\n//\nexport class ScalarSpec extends Property {\n}\nScalarSpec.__name__ = \"ScalarSpec\";\nexport class VectorSpec extends Property {\n    array(source) {\n        let ret;\n        if (this.spec.field != null) {\n            ret = this.transform(source.get_column(this.spec.field));\n            if (ret == null)\n                throw new Error(`attempted to retrieve property array for nonexistent field '${this.spec.field}'`);\n        }\n        else if (this.spec.expr != null) {\n            ret = this.transform(this.spec.expr.v_compute(source));\n        }\n        else {\n            let length = source.get_length();\n            if (length == null)\n                length = 1;\n            const value = this.value(false); // don't apply any spec transform\n            ret = repeat(value, length);\n        }\n        if (this.spec.transform != null)\n            ret = this.spec.transform.v_compute(ret);\n        return ret;\n    }\n}\nVectorSpec.__name__ = \"VectorSpec\";\nexport class DataSpec extends VectorSpec {\n}\nDataSpec.__name__ = \"DataSpec\";\nexport class UnitsSpec extends VectorSpec {\n    init() {\n        if (this.spec.units == null)\n            this.spec.units = this.default_units;\n        const units = this.spec.units;\n        if (!includes(this.valid_units, units))\n            throw new Error(`units must be one of ${this.valid_units.join(\", \")}; got: ${units}`);\n    }\n    get units() {\n        return this.spec.units;\n    }\n    set units(units) {\n        this.spec.units = units;\n    }\n}\nUnitsSpec.__name__ = \"UnitsSpec\";\nexport class AngleSpec extends UnitsSpec {\n    get default_units() { return \"rad\"; }\n    get valid_units() { return enums.AngleUnits; }\n    transform(values) {\n        if (this.spec.units == \"deg\")\n            values = map(values, (x) => x * Math.PI / 180.0);\n        values = map(values, (x) => -x);\n        return super.transform(values);\n    }\n}\nAngleSpec.__name__ = \"AngleSpec\";\nexport class BooleanSpec extends DataSpec {\n}\nBooleanSpec.__name__ = \"BooleanSpec\";\nexport class ColorSpec extends DataSpec {\n}\nColorSpec.__name__ = \"ColorSpec\";\nexport class CoordinateSpec extends DataSpec {\n}\nCoordinateSpec.__name__ = \"CoordinateSpec\";\nexport class CoordinateSeqSpec extends DataSpec {\n}\nCoordinateSeqSpec.__name__ = \"CoordinateSeqSpec\";\nexport class DistanceSpec extends UnitsSpec {\n    get default_units() { return \"data\"; }\n    get valid_units() { return enums.SpatialUnits; }\n}\nDistanceSpec.__name__ = \"DistanceSpec\";\nexport class FontSizeSpec extends DataSpec {\n}\nFontSizeSpec.__name__ = \"FontSizeSpec\";\nexport class MarkerSpec extends DataSpec {\n}\nMarkerSpec.__name__ = \"MarkerSpec\";\nexport class NumberSpec extends DataSpec {\n}\nNumberSpec.__name__ = \"NumberSpec\";\nexport class StringSpec extends DataSpec {\n}\nStringSpec.__name__ = \"StringSpec\";\nexport class NullStringSpec extends DataSpec {\n}\nNullStringSpec.__name__ = \"NullStringSpec\";\n//# sourceMappingURL=properties.js.map"]},"metadata":{},"sourceType":"module"}