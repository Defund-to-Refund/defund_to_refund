{"ast":null,"code":"import * as noUiSlider from \"nouislider\";\nimport * as p from \"../../core/properties\";\nimport { div, span, empty } from \"../../core/dom\";\nimport { repeat } from \"../../core/util/array\";\nimport { Control, ControlView } from \"./control\";\nimport { bk_slider_value, bk_slider_title, bk_input_group } from \"../../styles/widgets/sliders\";\nconst prefix = 'bk-noUi-';\n\nclass AbstractBaseSliderView extends ControlView {\n  get noUiSlider() {\n    return this.slider_el.noUiSlider;\n  }\n\n  initialize() {\n    super.initialize();\n  }\n\n  connect_signals() {\n    super.connect_signals();\n    const {\n      direction,\n      orientation,\n      tooltips\n    } = this.model.properties;\n    this.on_change([direction, orientation, tooltips], () => this.render());\n    const {\n      start,\n      end,\n      value,\n      step,\n      title\n    } = this.model.properties;\n    this.on_change([start, end, value, step], () => {\n      const {\n        start,\n        end,\n        value,\n        step\n      } = this._calc_to();\n\n      this.noUiSlider.updateOptions({\n        range: {\n          min: start,\n          max: end\n        },\n        start: value,\n        step\n      });\n    });\n    const {\n      bar_color\n    } = this.model.properties;\n    this.on_change(bar_color, () => {\n      this._set_bar_color();\n    });\n    const {\n      show_value\n    } = this.model.properties;\n    this.on_change([value, title, show_value], () => this._update_title());\n  }\n\n  _update_title() {\n    empty(this.title_el);\n    const hide_header = this.model.title == null || this.model.title.length == 0 && !this.model.show_value;\n    this.title_el.style.display = hide_header ? \"none\" : \"\";\n\n    if (!hide_header) {\n      if (this.model.title.length != 0) this.title_el.textContent = `${this.model.title}: `;\n\n      if (this.model.show_value) {\n        const {\n          value\n        } = this._calc_to();\n\n        const pretty = value.map(v => this.model.pretty(v)).join(\" .. \");\n        this.title_el.appendChild(span({\n          class: bk_slider_value\n        }, pretty));\n      }\n    }\n  }\n\n  _set_bar_color() {\n    if (!this.model.disabled) {\n      const connect_el = this.slider_el.querySelector(`.${prefix}connect`);\n      connect_el.style.backgroundColor = this.model.bar_color;\n    }\n  }\n\n  _keypress_handle(e, idx = 0) {\n    const {\n      start,\n      value,\n      end,\n      step\n    } = this._calc_to();\n\n    const is_range = value.length == 2;\n    let low = start;\n    let high = end;\n\n    if (is_range && idx == 0) {\n      high = value[1];\n    } else if (is_range && idx == 1) {\n      low = value[0];\n    }\n\n    switch (e.which) {\n      case 37:\n        {\n          value[idx] = Math.max(value[idx] - step, low);\n          break;\n        }\n\n      case 39:\n        {\n          value[idx] = Math.min(value[idx] + step, high);\n          break;\n        }\n\n      default:\n        return;\n    }\n\n    if (is_range) {\n      this.model.value = value;\n    } else {\n      this.model.value = value[0];\n    }\n\n    this.model.properties.value.change.emit();\n    this.model.value_throttled = this.model.value;\n    this.noUiSlider.set(value);\n  }\n\n  render() {\n    super.render();\n\n    const {\n      start,\n      end,\n      value,\n      step\n    } = this._calc_to();\n\n    let tooltips; // XXX\n\n    if (this.model.tooltips) {\n      const formatter = {\n        to: value => this.model.pretty(value)\n      };\n      tooltips = repeat(formatter, value.length);\n    } else tooltips = false;\n\n    if (this.slider_el == null) {\n      this.slider_el = div();\n      noUiSlider.create(this.slider_el, {\n        cssPrefix: prefix,\n        range: {\n          min: start,\n          max: end\n        },\n        start: value,\n        step,\n        behaviour: this.model.behaviour,\n        connect: this.model.connected,\n        tooltips,\n        orientation: this.model.orientation,\n        direction: this.model.direction\n      }); // XXX: bad typings; no cssPrefix\n\n      this.noUiSlider.on('slide', (_, __, values) => this._slide(values));\n      this.noUiSlider.on('change', (_, __, values) => this._change(values));\n\n      this._set_keypress_handles();\n\n      const toggleTooltip = (i, show) => {\n        if (!tooltips) return;\n        const handle = this.slider_el.querySelectorAll(`.${prefix}handle`)[i];\n        const tooltip = handle.querySelector(`.${prefix}tooltip`);\n        tooltip.style.display = show ? 'block' : '';\n      };\n\n      this.noUiSlider.on('start', (_, i) => toggleTooltip(i, true));\n      this.noUiSlider.on('end', (_, i) => toggleTooltip(i, false));\n    } else {\n      this.noUiSlider.updateOptions({\n        range: {\n          min: start,\n          max: end\n        },\n        start: value,\n        step\n      });\n    }\n\n    this._set_bar_color();\n\n    if (this.model.disabled) this.slider_el.setAttribute('disabled', 'true');else this.slider_el.removeAttribute('disabled');\n    this.title_el = div({\n      class: bk_slider_title\n    });\n\n    this._update_title();\n\n    this.group_el = div({\n      class: bk_input_group\n    }, this.title_el, this.slider_el);\n    this.el.appendChild(this.group_el);\n  }\n\n  _slide(values) {\n    this.model.value = this._calc_from(values);\n  }\n\n  _change(values) {\n    this.model.value = this._calc_from(values);\n    this.model.value_throttled = this.model.value;\n  }\n\n}\n\nAbstractBaseSliderView.__name__ = \"AbstractBaseSliderView\";\nexport class AbstractSliderView extends AbstractBaseSliderView {\n  _calc_to() {\n    return {\n      start: this.model.start,\n      end: this.model.end,\n      value: [this.model.value],\n      step: this.model.step\n    };\n  }\n\n  _calc_from([value]) {\n    if (Number.isInteger(this.model.start) && Number.isInteger(this.model.end) && Number.isInteger(this.model.step)) return Math.round(value);else return value;\n  }\n\n  _set_keypress_handles() {\n    // Add single cursor event\n    const handle = this.slider_el.querySelector(`.${prefix}handle`);\n    handle.setAttribute('tabindex', '0');\n    handle.addEventListener('keydown', e => this._keypress_handle(e));\n  }\n\n}\nAbstractSliderView.__name__ = \"AbstractSliderView\";\nexport class AbstractRangeSliderView extends AbstractBaseSliderView {\n  _calc_to() {\n    return {\n      start: this.model.start,\n      end: this.model.end,\n      value: this.model.value,\n      step: this.model.step\n    };\n  }\n\n  _calc_from(values) {\n    return values;\n  }\n\n  _set_keypress_handles() {\n    const handle_lower = this.slider_el.querySelector(`.${prefix}handle-lower`);\n    const handle_upper = this.slider_el.querySelector(`.${prefix}handle-upper`);\n    handle_lower.setAttribute('tabindex', '0');\n    handle_lower.addEventListener('keydown', e => this._keypress_handle(e, 0));\n    handle_upper.setAttribute('tabindex', '1');\n    handle_upper.addEventListener('keydown', e => this._keypress_handle(e, 1));\n  }\n\n}\nAbstractRangeSliderView.__name__ = \"AbstractRangeSliderView\";\nexport class AbstractSlider extends Control {\n  constructor(attrs) {\n    super(attrs);\n    this.connected = false;\n  }\n\n  static init_AbstractSlider() {\n    this.define({\n      title: [p.String, \"\"],\n      show_value: [p.Boolean, true],\n      start: [p.Any],\n      end: [p.Any],\n      value: [p.Any],\n      value_throttled: [p.Any],\n      step: [p.Number, 1],\n      format: [p.Any],\n      direction: [p.Any, \"ltr\"],\n      tooltips: [p.Boolean, true],\n      bar_color: [p.Color, \"#e6e6e6\"]\n    });\n  }\n\n  _formatter(value, _format) {\n    return `${value}`;\n  }\n\n  pretty(value) {\n    return this._formatter(value, this.format);\n  }\n\n}\nAbstractSlider.__name__ = \"AbstractSlider\";\nAbstractSlider.init_AbstractSlider();","map":{"version":3,"sources":["/Users/gen/Desktop/defund_to_refund/node_modules/@bokeh/bokehjs/build/js/lib/models/widgets/abstract_slider.js"],"names":["noUiSlider","p","div","span","empty","repeat","Control","ControlView","bk_slider_value","bk_slider_title","bk_input_group","prefix","AbstractBaseSliderView","slider_el","initialize","connect_signals","direction","orientation","tooltips","model","properties","on_change","render","start","end","value","step","title","_calc_to","updateOptions","range","min","max","bar_color","_set_bar_color","show_value","_update_title","title_el","hide_header","length","style","display","textContent","pretty","map","v","join","appendChild","class","disabled","connect_el","querySelector","backgroundColor","_keypress_handle","e","idx","is_range","low","high","which","Math","change","emit","value_throttled","set","formatter","to","create","cssPrefix","behaviour","connect","connected","on","_","__","values","_slide","_change","_set_keypress_handles","toggleTooltip","i","show","handle","querySelectorAll","tooltip","setAttribute","removeAttribute","group_el","el","_calc_from","__name__","AbstractSliderView","Number","isInteger","round","addEventListener","AbstractRangeSliderView","handle_lower","handle_upper","AbstractSlider","constructor","attrs","init_AbstractSlider","define","String","Boolean","Any","format","Color","_formatter","_format"],"mappings":"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","sourcesContent":["import * as noUiSlider from \"nouislider\";\nimport * as p from \"../../core/properties\";\nimport { div, span, empty } from \"../../core/dom\";\nimport { repeat } from \"../../core/util/array\";\nimport { Control, ControlView } from \"./control\";\nimport { bk_slider_value, bk_slider_title, bk_input_group } from \"../../styles/widgets/sliders\";\nconst prefix = 'bk-noUi-';\nclass AbstractBaseSliderView extends ControlView {\n    get noUiSlider() {\n        return this.slider_el.noUiSlider;\n    }\n    initialize() {\n        super.initialize();\n    }\n    connect_signals() {\n        super.connect_signals();\n        const { direction, orientation, tooltips } = this.model.properties;\n        this.on_change([direction, orientation, tooltips], () => this.render());\n        const { start, end, value, step, title } = this.model.properties;\n        this.on_change([start, end, value, step], () => {\n            const { start, end, value, step } = this._calc_to();\n            this.noUiSlider.updateOptions({\n                range: { min: start, max: end },\n                start: value,\n                step,\n            });\n        });\n        const { bar_color } = this.model.properties;\n        this.on_change(bar_color, () => {\n            this._set_bar_color();\n        });\n        const { show_value } = this.model.properties;\n        this.on_change([value, title, show_value], () => this._update_title());\n    }\n    _update_title() {\n        empty(this.title_el);\n        const hide_header = this.model.title == null || (this.model.title.length == 0 && !this.model.show_value);\n        this.title_el.style.display = hide_header ? \"none\" : \"\";\n        if (!hide_header) {\n            if (this.model.title.length != 0)\n                this.title_el.textContent = `${this.model.title}: `;\n            if (this.model.show_value) {\n                const { value } = this._calc_to();\n                const pretty = value.map((v) => this.model.pretty(v)).join(\" .. \");\n                this.title_el.appendChild(span({ class: bk_slider_value }, pretty));\n            }\n        }\n    }\n    _set_bar_color() {\n        if (!this.model.disabled) {\n            const connect_el = this.slider_el.querySelector(`.${prefix}connect`);\n            connect_el.style.backgroundColor = this.model.bar_color;\n        }\n    }\n    _keypress_handle(e, idx = 0) {\n        const { start, value, end, step } = this._calc_to();\n        const is_range = value.length == 2;\n        let low = start;\n        let high = end;\n        if (is_range && idx == 0) {\n            high = value[1];\n        }\n        else if (is_range && idx == 1) {\n            low = value[0];\n        }\n        switch (e.which) {\n            case 37: {\n                value[idx] = Math.max(value[idx] - step, low);\n                break;\n            }\n            case 39: {\n                value[idx] = Math.min(value[idx] + step, high);\n                break;\n            }\n            default:\n                return;\n        }\n        if (is_range) {\n            this.model.value = value;\n        }\n        else {\n            this.model.value = value[0];\n        }\n        this.model.properties.value.change.emit();\n        this.model.value_throttled = this.model.value;\n        this.noUiSlider.set(value);\n    }\n    render() {\n        super.render();\n        const { start, end, value, step } = this._calc_to();\n        let tooltips; // XXX\n        if (this.model.tooltips) {\n            const formatter = {\n                to: (value) => this.model.pretty(value),\n            };\n            tooltips = repeat(formatter, value.length);\n        }\n        else\n            tooltips = false;\n        if (this.slider_el == null) {\n            this.slider_el = div();\n            noUiSlider.create(this.slider_el, {\n                cssPrefix: prefix,\n                range: { min: start, max: end },\n                start: value,\n                step,\n                behaviour: this.model.behaviour,\n                connect: this.model.connected,\n                tooltips,\n                orientation: this.model.orientation,\n                direction: this.model.direction,\n            }); // XXX: bad typings; no cssPrefix\n            this.noUiSlider.on('slide', (_, __, values) => this._slide(values));\n            this.noUiSlider.on('change', (_, __, values) => this._change(values));\n            this._set_keypress_handles();\n            const toggleTooltip = (i, show) => {\n                if (!tooltips)\n                    return;\n                const handle = this.slider_el.querySelectorAll(`.${prefix}handle`)[i];\n                const tooltip = handle.querySelector(`.${prefix}tooltip`);\n                tooltip.style.display = show ? 'block' : '';\n            };\n            this.noUiSlider.on('start', (_, i) => toggleTooltip(i, true));\n            this.noUiSlider.on('end', (_, i) => toggleTooltip(i, false));\n        }\n        else {\n            this.noUiSlider.updateOptions({\n                range: { min: start, max: end },\n                start: value,\n                step,\n            });\n        }\n        this._set_bar_color();\n        if (this.model.disabled)\n            this.slider_el.setAttribute('disabled', 'true');\n        else\n            this.slider_el.removeAttribute('disabled');\n        this.title_el = div({ class: bk_slider_title });\n        this._update_title();\n        this.group_el = div({ class: bk_input_group }, this.title_el, this.slider_el);\n        this.el.appendChild(this.group_el);\n    }\n    _slide(values) {\n        this.model.value = this._calc_from(values);\n    }\n    _change(values) {\n        this.model.value = this._calc_from(values);\n        this.model.value_throttled = this.model.value;\n    }\n}\nAbstractBaseSliderView.__name__ = \"AbstractBaseSliderView\";\nexport class AbstractSliderView extends AbstractBaseSliderView {\n    _calc_to() {\n        return {\n            start: this.model.start,\n            end: this.model.end,\n            value: [this.model.value],\n            step: this.model.step,\n        };\n    }\n    _calc_from([value]) {\n        if (Number.isInteger(this.model.start) && Number.isInteger(this.model.end) && Number.isInteger(this.model.step))\n            return Math.round(value);\n        else\n            return value;\n    }\n    _set_keypress_handles() {\n        // Add single cursor event\n        const handle = this.slider_el.querySelector(`.${prefix}handle`);\n        handle.setAttribute('tabindex', '0');\n        handle.addEventListener('keydown', (e) => this._keypress_handle(e));\n    }\n}\nAbstractSliderView.__name__ = \"AbstractSliderView\";\nexport class AbstractRangeSliderView extends AbstractBaseSliderView {\n    _calc_to() {\n        return {\n            start: this.model.start,\n            end: this.model.end,\n            value: this.model.value,\n            step: this.model.step,\n        };\n    }\n    _calc_from(values) {\n        return values;\n    }\n    _set_keypress_handles() {\n        const handle_lower = this.slider_el.querySelector(`.${prefix}handle-lower`);\n        const handle_upper = this.slider_el.querySelector(`.${prefix}handle-upper`);\n        handle_lower.setAttribute('tabindex', '0');\n        handle_lower.addEventListener('keydown', (e) => this._keypress_handle(e, 0));\n        handle_upper.setAttribute('tabindex', '1');\n        handle_upper.addEventListener('keydown', (e) => this._keypress_handle(e, 1));\n    }\n}\nAbstractRangeSliderView.__name__ = \"AbstractRangeSliderView\";\nexport class AbstractSlider extends Control {\n    constructor(attrs) {\n        super(attrs);\n        this.connected = false;\n    }\n    static init_AbstractSlider() {\n        this.define({\n            title: [p.String, \"\"],\n            show_value: [p.Boolean, true],\n            start: [p.Any],\n            end: [p.Any],\n            value: [p.Any],\n            value_throttled: [p.Any],\n            step: [p.Number, 1],\n            format: [p.Any],\n            direction: [p.Any, \"ltr\"],\n            tooltips: [p.Boolean, true],\n            bar_color: [p.Color, \"#e6e6e6\"],\n        });\n    }\n    _formatter(value, _format) {\n        return `${value}`;\n    }\n    pretty(value) {\n        return this._formatter(value, this.format);\n    }\n}\nAbstractSlider.__name__ = \"AbstractSlider\";\nAbstractSlider.init_AbstractSlider();\n//# sourceMappingURL=abstract_slider.js.map"]},"metadata":{},"sourceType":"module"}